/*
	AudioBank.h
	20251001  hanaue sho
	音源をまとめて保管する役割（複数のAudioClipを管理）
*/
#ifndef AUDIOBANK_H_
#define AUDIOBANK_H_
#include <unordered_map>
#include <memory>
#include <string>
#include <vector>
#include "AudioClip.h"

class AudioBank
{
private:
	// ==================================================
	// 本体要素
	// ==================================================
	// --------------------------------------------------
	// 読み込んだ音源のプール
	// --------------------------------------------------
	static std::unordered_map<std::string, std::shared_ptr<AudioClip>> s_Pinned;

	// ==================================================
	// ヘルパ
	// ==================================================
	// --------------------------------------------------
	// パスの正規化
	// --------------------------------------------------
	static std::string NormalizePathKey(const char* path);
	// --------------------------------------------------
	// .wav の判定
	// --------------------------------------------------
	static bool IsWaveExt(const std::string& path);
	// --------------------------------------------------
	// ディレクトリ走査
	// --------------------------------------------------
	static int PinDirectoryImpl(const std::string& dirNormalized, bool recursive);

public:
	// --------------------------------------------------
	// 音源をロード
	// --------------------------------------------------
	static bool Pin(const char* path);
	// --------------------------------------------------
	// 音源の取得
	// ピン済みならそれを返す
	// 未ピンならその場で AudioClip::Load() で取得（保持はしない）
	// --------------------------------------------------
	static std::shared_ptr<AudioClip> Get(const char* path);
	// --------------------------------------------------
	// ピンの解放
	// 他で共有されている場合は残る
	// --------------------------------------------------
	static void Unpin(const char* path);
	// --------------------------------------------------
	// ピンの状態確認
	// --------------------------------------------------
	static bool IsPinned(const char* path);
	// --------------------------------------------------
	// 指定したディレクトリ配下をまとめてピン
	// --------------------------------------------------
	static int PinDirectory(const char* dirPath, bool recursive = true);

	// ==================================================
	// ライフサイクル
	// ==================================================
	// --------------------------------------------------
	// 終了処理
	// 全て解除
	// --------------------------------------------------
	static void Clear();

};


#endif