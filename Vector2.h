/*
	Vector2 のクラス
	20251006  hanaue sho
*/
#ifndef VECTOR2_H_
#define VECTOR2_H_
#include <math.h>
#include <cassert>
#include <string>
#include "MathCommon.h"

class Vector2
{
public:
	// ==================================================
	// ----- 要素本体 -----
	// v = {x, y}
	// ==================================================
	float x = 0, y = 0;

	// ==================================================
	// ----- コンストラクタ -----
	// ==================================================
	Vector2() {}
	Vector2(const Vector2& a) : x(a.x), y(a.y) {}
	Vector2(float nx, float ny) : x(nx), y(ny) {}

	// ==================================================
	// ----- オペレータ -----
	// ==================================================
	// --------------------------------------------------
	// 標準的なオブジェクトの保守
    // --------------------------------------------------
    // --------------------------------------------------
	// 代入（C言語の慣習に従い値への参照を返す）
    // --------------------------------------------------
	Vector2& operator = (const Vector2& a)
	{ x = a.x; y = a.y; return *this; }
	// --------------------------------------------------
	// 等しさチェック
    // --------------------------------------------------
	bool operator == (const Vector2& a) const
	{ return x == a.x && y == a.y ;}
	bool operator != (const Vector2& a) const
	{ return x != a.x || y != a.y ;}

	// --------------------------------------------------
	// ベクトル操作
	// --------------------------------------------------
	// --------------------------------------------------
	// 加算
    // --------------------------------------------------
	Vector2 operator +() const { return *this; }
	// --------------------------------------------------
	// 単項式のマイナスは、反転したベクトルを返す
    // --------------------------------------------------
	Vector2 operator -() const { return Vector2(-x, -y); }
	// --------------------------------------------------
	// 二項式の＋と−はベクトルを加算し、減算する
    // --------------------------------------------------
	Vector2 operator +(const Vector2& a) const 
	{ return Vector2(x + a.x, y + a.y); }
	Vector2 operator -(const Vector2& a) const
	{ return Vector2(x - a.x, y - a.y); }
	// --------------------------------------------------
	// スカラーによる乗算と除算
    // --------------------------------------------------
	Vector2 operator *(float a) const
	{ return Vector2(x * a, y * a); }
	// --------------------------------------------------
	// ベクトルの各要素の乗算
    // --------------------------------------------------
	Vector2 operator *(const Vector2& a) const
	{
		return Vector2(x * a.x, y * a.y);
	}
	Vector2 operator /(float a) const
	{
		if (a == 0.0f) return Vector2(0, 0);// ※ゼロ除算チェック
		float oneOverA = 1.0f / a; 
		return Vector2(x * oneOverA, y * oneOverA); 
	}
	// --------------------------------------------------
	// 要素の取り出し
    // --------------------------------------------------
	float& operator [](int i) 
	{
		assert(0 <= i && i < 2);
		switch (i)
		{
		case 0: return x;
		case 1: return y;
		}
	}
	const float& operator [](int i) const
	{
		assert(0 <= i && i < 2);
		switch (i)
		{
		case 0: return x;
		case 1: return y;
		}
	}
	// --------------------------------------------------
	// 組み合わせ代入演算子
    // --------------------------------------------------
	Vector2& operator +=(const Vector2& a)
	{ x += a.x; y += a.y; return *this; }
	Vector2& operator -=(const Vector2& a)
	{ x -= a.x; y -= a.y; return *this; }
	Vector2& operator *=(const Vector2& a) // 要素ごとの乗算（アダマール積）
	{ x *= a.x; y *= a.y; return *this; }
	Vector2& operator /=(const Vector2& a)
	{
		if (a.x == 0 || a.y == 0) return *this;
		x /= a.x; y /= a.y; return *this; 
	}
	Vector2& operator *=(float s) 
	{ x *= s; y *= s; return *this;}
	Vector2& operator /=(float s) 
	{ x /= s; y /= s; return *this;}
	
	// ==================================================
	// ----- ユーティリティ -----
	// ==================================================
    // --------------------------------------------------
	// ベクトルを正規化する
    // --------------------------------------------------
	void normalize()
	{
		float magSq = x * x + y * y;
		if (magSq > 0.0f)
		{
			float oneOverMag = 1.0f / sqrtf(magSq);
			x *= oneOverMag;
			y *= oneOverMag;
		}
	}
	// --------------------------------------------------
	// ベクトルの正規化のコピーを返す
    // --------------------------------------------------
	Vector2 normalized() const
	{
		float magSq = x * x + y * y;
		if (magSq > 0.0f)
		{
			float oneOverMag = 1.0f / sqrtf(magSq);
			return Vector2(x * oneOverMag, y * oneOverMag);
		}
		return Vector2(0, 0);
	}
	// --------------------------------------------------
	// ベクトルの長さを返す
	// --------------------------------------------------
	float length() const
	{
		return sqrtf(x * x + y * y);
	}
	// --------------------------------------------------
	// ベクトルの長さの二乗を返す
	// --------------------------------------------------
	float lengthSq() const
	{
		return x * x + y * y;
	}
	// --------------------------------------------------
	// ベクトルを０にする
	// --------------------------------------------------
	void zero() { x = y = 0.0f; }

	// ==================================================
	// ----- 内積・外積 -----
	// ==================================================
	// --------------------------------------------------
	// ベクトルの外積（右手系）
	// --------------------------------------------------
	static float Cross(const Vector2& a, const Vector2& b)
	{
		return a.x * b.y - a.y * b.x;
	}
	// --------------------------------------------------
	// ベクトルの外積（左手座標系）
	// --------------------------------------------------
	static float CrossLH(const Vector2& a, const Vector2& b) 
	{ 
		return -Cross(a, b); 
	}
	// --------------------------------------------------
	// ベクトルの内積
	// --------------------------------------------------
	static float Dot(const Vector2& a, const Vector2& b)
	{
		return a.x * b.x + a.y * b.y;
	}

	// ==================================================
	// ----- ゴリラヘルパ -----
	// ==================================================
	// --------------------------------------------------
	// 要素を printf で出力（意外と便利）
	// --------------------------------------------------
	static void Printf(const Vector2& v, std::string s = "noname")
	{
		printf("%s : {%f, %f}\n", s.c_str(), v.x, v.y);
	}
};

// ==================================================
// ----- オペレータ（逆版） -----
// ==================================================
inline Vector2 operator *(float s, const Vector2& v)
{
	return Vector2(v.x * s, v.y * s);
}
// 任意：スカラーを各成分で割った特殊用途（例えば reciprocal のような使い方）
inline Vector2 operator /(float s, const Vector2& v)
{
	return Vector2(s / v.x, s / v.y); // 任意（特殊な用途向け）
}


#endif